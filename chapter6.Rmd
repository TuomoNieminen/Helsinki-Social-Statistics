---
title       : Conditions and subsets
description : UNDER CONSTRUCTION

--- type:NormalExercise lang:r xp:100 skills:1 key:da73cb2b07
## Wellcome to part 2

In the following chapters (6-10) we will be using a dataset collected from students in the Faculty of Social Sciences in the University of Helsinki. The students filled out this questionaire[link] and the answers were later combined into the following combination variables:

- *deep*: mean score of questions related to deep learning
- *stra*: mean score of questions related to strategic learning
- *surf*: mean score of questions related to surface learning
- *attitude*: mean score of questions related to attitude toward statistics  

The *learning2014* dataset includes these variables along with the students age and gender. The data also includes the students points in a statistics exam. Zero points means that the student did not attend an exam.

*** =instructions
- Look at the structure of learning2014
- Look at the first six observations of learning2014
- Compute a summary of all the variables in learning2014 (with a single function call)

*** =hint
- Use `head()` to look at the first six observations
- Use `summary()` on learning2014 to compute the summaries of the variables

*** =pre_exercise_code
```{r}
learning2014 <-  read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)

```

*** =sample_code
```{r}
# learning2014 is available

# Look at the structure of learning2014
str(learning2014)

# Look at the first six observations of learning2014


# Compute a summary of the variables in learning2014




```

*** =solution
```{r}
# learning2014 is available

# Look at the structure of learning2014
str(learning2014)

# Look at the first six observations of learning2014
head(learning2014)

# Compute a summary of the variables in learning2014
summary(learning2014)


```

*** =sct
```{r}

# test_object("object_name")
test_function("str", args=c("object"))
test_function("head", args=c("x"))
test_function("summary", args=c("object"))

test_error()
success_msg("Good work!")
```

--- type:NormalExercise lang:r xp:100 skills:1 key:d64c2a9918

## Exlore your data

In this exercise you will use already familiar tools to get a little more intimate with your data. A couple quick notes related to the example code:

- breaks = `1:5` is identical to breaks =  `c(1, 2, 3, 4, 5)`
- `T` can be used to abbreviate `TRUE`
- The argument *include.lowest* makes the lowest break point value given to `cut()` inclusive

Follow the instructions below to complete the exercise:

*** =instructions
- Browse through the different plots to look at the distributions of the variables in learning2014
- Similarily to the example code: Create object `attitude` by transforming attitude into a factor and compute the counts with table()
- Visualize the counts with a bar plot
- Give your plot the main title: "Distribution of students scores on attitude towards statistics"

*** =hint
- Use the variable `attitude` in the learning2014 data identically to the example codes where the variable is `deep`.
- The argument main can be used inside the barplot() function to add a main title

*** =pre_exercise_code
```{r}
# data
learning2014 <-  read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)
points <- table(cut(learning2014$points, (0:11)*3, include.lowest=T))
deep <- table(cut(learning2014$deep, 1:5, include.lowest = T))
stra <- table(cut(learning2014$stra, 1:5, include.lowest = T))
surf <- table(cut(learning2014$surf, 1:5, include.lowest = T))

# plots
barplot(table(learning2014$gender), main = "Distribution of students gender")
boxplot(learning2014$age, main = "Box plot of students age", xlab = "age", horizontal = T)
barplot(points, las = 2, main = "Distribution of students exam points", xlab = "")
barplot(surf, main = "Distribution of students scores on surface learning")
barplot(deep, main = "Distribution of students scores on deep learning")
barplot(stra, main = "Distribution of students scores on strategic learning")

```

*** =sample_code
```{r}
# learning2014 is available

# Counts of deep learning categories
deep <- table(cut(learning2014$deep, breaks = 1:5, include.lowest = T))

# Visualize the counts
barplot(deep, main = "Distribution of students scores on deep learning")

# Compute counts of attitude


# Visualize the counts



```

*** =solution
```{r}
# learning2014 is available

# Counts of deep learning categories
deep <- table(cut(learning2014$deep, breaks = 1:5, include.lowest = T))

# Visualize the counts
barplot(deep, main = "Distribution of students scores on deep learning")

# Compute counts of attitude
attitude <- table(cut(learning2014$attitude, breaks = 1:5, include.lowest = T))

# Visualize the counts
barplot(attitude, main = "Distribution of students scores on attitude towards statistics")


```

*** =sct
```{r}

test_object("attitude")

test_error()
success_msg("Great work!")
```


--- type:NormalExercise lang:r xp:100 skills:1 key:c12d1b7017

## Selecting a subset()

You have already learned how to look at your data with visualizations and summaries. This is great, but often there is a need to zoom in on a **subset** of the data matching some *condition*.

There are multiple ways to select a subset in R. Perhaps the most convenient method is the `subset()` function. `subset()` is a generic function that works with several data formats. The first argument of `subset()` is the data and the second argument are the *logical conditions* for selecting parts of the data.  

When used on a data.frame, `subset()` returns the rows of the data.frame which match the logical conditions. You will soon learn more about logical conditions.

*** =instructions
- Create object stra_learners by executing the example codes
- Look at the first 6 rows of the strategic learners subdata
- Create your own subset by selecting the students with attitude less than 3

*** =hint
- Use the functions `head()` and `subset()` as in the example codes.
- The strategic learning variable is named `stra`. The attitude variable is named `attitude`.
- Use the operator `<` similarily to it's counterpart `>` in the example.


*** =pre_exercise_code
```{r}
learning2014 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)

# Look at the first six observations
head(learning2014)

```

*** =sample_code
```{r}
# learning2014 is available

# Look at the first six observations
head(learning2014)

# select students with above (>) 4 strategic learning
stra_learners <- subset(learning2014, stra > 4)

# Look at the first 6 rows of stra_learners


# select students with below (<) 3 attitude
attitude_low <- 


```

*** =solution
```{r}
# learning2014 is available

# Look at the first six observations
head(learning2014)

# select students with above (>) 4 strategic learning
stra_learners <- subset(learning2014, stra > 4)

# Look at the first 6 rows of the subdata
head(stra_learners)

# select students with below (<) 3 attitude
attitude_low <- subset(learning2014, attitude < 3)


```

*** =sct
```{r}
# submission correctness tests

# example tests:
test_output_contains("head(stra_learners)")
test_object("attitude_low")

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Excellent work!")

```

--- type:NormalExercise lang:r xp:100 skills:1 key:73f94cfacf

## Logical comparison

What you just saw inside the `subset()` function was  **logical comparison**. Logical comparison creates logical vectors, which can be used to select subsets of data. Logical conditions have other uses as well and are generally important in programming tasks.  

The logical comparison operators in R are:  

operator  | description
----------|------------
`==`      | exactly equal to
`!=`      | not equal to
`<`       | less than
`>`       | greater than
`<=`      | less or equal to
`>=`      | greater or equal to

Follow the instructions below to complete the exercise.  

*** =instructions
- Execute and study the example codes
- Add to the row with `c("a","b","c")`: select a suitable logical comparison operator and a suitable comparison value to produce a result vector `FALSE, FALSE, TRUE`
- Add to the row with `c(1,3,2)`: select a suitable logical comparison operator and a suitable comparison value to produce a result vector `TRUE, FALSE, TRUE`
- Bonus: can you think of other ways of achieving the same results?

*** =hint
- The third example should point you in the right direction
- If you're uncertain, just choose a comparison value and try out a bunch of different operators to figure out what might work.


*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# exactly equal
5 == 5 # TRUE

# Not equal
"cat" != "dog" # TRUE

# Greater or equal 3 times
c(0,1,2) >= 1 # F, T, T

# Use logical comparison to produce a result F, F, T
c("a","b","c")

# Use logical comparison to produce a result T, F, T
c(1, 3, 2)


```

*** =solution
```{r}
# exactly equal
5 == 5 # TRUE

# Not equal
"cat" != "dog" # TRUE

# Greater or equal 3 times
c(0,1,2) >= 1 # F,T,T

# Use logical comparison to produce a result F,F,T
c("a","b","c") == "c"

# Use logical comparison to produce a result T,F,T
c(1,3,2) < 3

```

*** =sct
```{r}
# submission correctness tests

# example tests:
test_output_contains("c('a','b','c')=='c'", incorrect_msg = "Please make the necessary adustments to produce the output FALSE FALSE TRUE")

test_output_contains("c(1,3,2)<3", incorrect_msg = "Please make the necessary adustments to produce the output TRUE FALSE TRUE")

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Well done! Remember Spock's words: Logic is the beginning of wisdom, not the end.")

```

--- type:NormalExercise lang:r xp:100 skills:1 key:d7b5a24d40

## Logical operators

Logical conditions can be combined with the following logical operators:

operator                | description
----------------------- | -----------
`!`a                    | not a
a `&` b                 | a and b
a <code>&#124;</code> b | a or b  

Logical operators work like logical conditions: they compare the elements of vectors one at a time and can produce logical vectors.

So, for example `c(F, T) & c(T, T)` produces a logical vector `FALSE TRUE` because `F & T` equals `FALSE` and `T & T` equals `TRUE` (T and F abbreviate FALSE and TRUE).

It is also possible to use parenthesis to control the evaluation of the operators. See how this works from the example codes.

*** =instructions
- Create and print out four subsets of the learning2014 data matching the following conditions: 
- (gender is male) AND (deep learning is greater than 4.5)
- (age is 25 OR age is 26) AND (attitude is greater than 3.5)
- (gender is female) AND (strategic learning is greater than 4.5)
- (deep learning is more than 4) AND (points is zero OR points is greater than 30)

*** =hint
- The instructions show the correct use of parenthesis when using the logical operators and conditions
- Note that the logical equals is `==`, not `=`.


*** =pre_exercise_code
```{r}
learning2014 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)

```

*** =sample_code
```{r}
# learning2014 is available

# male students who scored very high on deep learning
subset(learning2014, (gender == "M") & (deep > 4.5))

# 25 or 26 old students who scored high on attitude
subset(learning2014, (age == 25 | age == 26) & (attitude > 3.5))

# female students who scored very high on strategic learning


# students who scored high on deep learning for whom points is 0 or greater than 30



```

*** =solution
```{r}
# learning2014 is available

# male students who scored very high on deep learning
subset(learning2014, (gender == "M") & (deep > 4.5))

# 25 or 26 old students who scored high on attitude
subset(learning2014, (age == 25 | age == 26) & (attitude > 3.5))

# female students who scored very high on strategic learning
subset(learning2014, (gender == "N") & (stra > 4.5))

# students who scored high on deep learning for whom points is 0 or greater than 30
subset(learning2014, deep > 4 & (points == 0 | points > 30))


```

*** =sct
```{r}
# submission correctness tests

test_output_contains("subset(learning2014,(gender=='N')&(stra>4.5))", incorrect_msg="Please print out the subset containing the female students with high strategic learning scores")
test_output_contains("subset(learning2014,deep>4&(points==0|points>30))", incorrect_msg="Please print out the subset containing the students who scored high on deep learning and had either no points or very high points")

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Excellent! You are the operator indeed.")

```

--- type:NormalExercise lang:r xp:100 skills:1 key:71e768aa4c

## Classical probability

Probability is the measure of the likelihood that an event will occur. It is quantified as a number between 0 and 1. Probability is an **essential** tool for statistics since the discipline is primarily interested in measuring uncertainty.

The classical definition of probability is the proportion of favourable cases over all possible outcomes. Thus, the probability of event $A$ with $f$ favourable cases out of $N$ possible outcomes is:

$$P(A) = \frac{f}{N}$$

For the questions below assume that we randomly pick a single student from the learning2014 data.

*** =instructions
- What is the probability that the student is female?
- What is the probability that the student has scored more than 3 on attitude?
- What is the probability that the student is male and has scored more than 4  on attitude?
- Combine all the probabilities to a vector with `c()` and print it out, rounded to 2 digits

*** =hint
- Use the table created and count the number of favourable cases (f) and the number of all possible cases (N)
- The asked probabilities are then f / N
- Use a comma to combine multiple values with `c()`.


*** =pre_exercise_code
```{r}
learning2014 <-  read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)

# transform attitude into a factor and cross table with gender
attitude <- cut(learning2014$attitude, 1:5, include.lowest = T)
gndr_att <- table(learning2014$gender, attitude)
print(addmargins(gndr_att))

```

*** =sample_code
```{r}
# learning2014 is available

# transform attitude into a factor and cross table with gender
attitude <- cut(learning2014$attitude, 1:5, include.lowest = T)
gndr_att <- table(learning2014$gender, attitude)
addmargins(gndr_att)

# P(gender = M)
p1 <- 61 / 183

# P(gender = N)
p2 <- 

# P(attitude > 3)  
p3 <-

# P(gender = M, attitude > 4)
p4 <- 

# Print out the probabilities
round(c(p1), digits = 2)


```

*** =solution
```{r}
# learning2014 is available

# transform attitude into a factor and cross table with gender
attitude <- cut(learning2014$attitude, 1:5, include.lowest = T)
gndr_att <- table(learning2014$gender, attitude)
addmargins(gndr_att)

# P(gender = M)
p1 <- 61 / 183

# P(gender = N)
p2 <- 122 / 183

# P(attitude > 3)  
p3 <- (85+19) / 183

# P(gender = M, attitude > 4)
p4 <- 12 / 183

# Print out the probabilities
round(c(p1, p2, p3, p4),2)


```

*** =sct
```{r}
# submission correctness tests

# example tests:
test_object("p2")
test_object("p3")
test_object("p4")

test_output_contains("round(c(p1, p2, p3, p4),2)")

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Great! You are probably a genius!")


```

--- type:NormalExercise lang:r xp:100 skills:1 key:562f9818e0

## Conditional probability

As you saw before, conditioning is closely related to selecting a subset. The condition defines the subset of the possible cases. This is also a good way to think about conditional probability: The condition defines the subset of possible outcomes.

Formally, conditional probability is defined by the Bayes formula

$$P(A | B) = \frac{P(A \text{ and } B)}{P(B)}$$

But we won't directly need to apply that definition here. 

For the questions below assume that we randomly pick a single student from the learning2014 data. 

*** =instructions
- What is the probability that the student has scored over 4 on attitude, on the condition that the student is female?
- What is the probability that the student is male, on the condition that the student has scored over 4 on attitude?
- What is the probability that the student is female, on the condition that the student has scored over 4 on attitude?

*** =hint
- Remember that classical probability is the frequency of favourable outcomes over all possible outcomes Now, the condition determines the subset for the possible outcomes


*** =pre_exercise_code
```{r}
learning2014 <-  read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)

# transform attitude into a factor and cross table with gender
attitude <- cut(learning2014$attitude, 1:5, include.lowest = T)
gndr_att <- table(learning2014$gender, attitude)
print(addmargins(gndr_att))

```

*** =sample_code
```{r}

# P(attitude > 4 | gender = M)
p1 <- 12 / 61

# P(attitude > 4 | gender = N)
p2 <- 

# P(gender = M | attitude > 4)
p3 <- 

# P(gender = N | attitude > 4)
p4 <- 

# Print out the probabilities
round(c(p1), digits = 2)

```

*** =solution
```{r}
# P(attitude > 4 | gender = M)
p1 <-  12 / 61

# P(attitude > 4 | gender = N)
p2 <-  7 / 122

# P(gender = M | attitude > 4)
p3 <- 12 / 19

## P(gender = N | attitude > 4)
p4 <- 7 / 19

# Print out the probabilities
round(c(p1, p2, p3, p4), digits = 2)

```

*** =sct
```{r}
# submission correctness tests

# example tests:
test_object("p1")
test_object("p2")
test_object("p3")
test_object("p4")
test_output_contains("round(c(p1, p2, p3, p4), 2)")

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Wow!! You are awsome no matter the conditions!")

```

