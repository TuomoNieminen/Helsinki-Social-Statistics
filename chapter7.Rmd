---
title       : Probability distributions
description : UNDER CONSTRUCTION

--- type:NormalExercise lang:r xp:100 skills:1 key:ef878aeeea

## Random variables and their probability distributions

In this chapter you will learn about [random variables](https://en.wikipedia.org/wiki/Random_variable) and [probability distributions](https://en.wikipedia.org/wiki/Probability_distribution). 

Random variables can have a set of different values. Every value has a probability of occurance. The probabilities of the values form a probability distribution for the random variable. Random variables and probability distributions can be discrete or continous.

There are things or events that are known to follow certain probability distributions (like the heights of people usually are normally distributed), but there are also many phenomenas that have their unique distributions. In R you can create a sample from distribution with the function `sample()`. See the example code to get the general idea. 

*** =instructions
- Create variable `tomorrow` with events `cat attacks baby`, `world ends` and `I eat pasta`.
- Set probabilities to the events of variable `tomorrow`.
- Draw a [*sample*](https://en.wikipedia.org/wiki/Sample_(statistics)) from tomorrow when the sample size is 1. Are you suprised with the outcome?
- Draw another sample, this time with sample size = `100`. Save the results to `my_sample`. Note the argument `replace` in the function `sample()`. What do you think it does? 
- Visualize the sample with bar plot. Notice how the bar heights in the barplot are related to the probabilities we set earlier.

*** =hint
- Did you specify the sample size correctly in the object `my_sample`? If not, the code will produce an error.
- The argument `size` in the `sample()` function is used to determine the sample size.


*** =pre_exercise_code
```{r}

```

*** =sample_code
```{r}
# create variable 'tomorrow' 
tomorrow <- c("cat attacks baby","world ends","I eat pasta")

# set probabilities to events
probabilities <- c(0.2, 0.3, 0.5)

# draw a sample
sample(tomorrow, size = 1, prob = probabilities)


# draw a sample 100 times
my_sample <- sample(tomorrow, size = , replace = TRUE, prob = probabilities)

# visualize the distribution
barplot(table(my_sample))

```

*** =solution
```{r}
# create variable 'tomorrow' 
tomorrow <- c("cat attacks baby","world ends","I eat pasta")

# set probabilities to events
probabilities <- c(0.2, 0.3, 0.5)

# draw a sample
sample(tomorrow, size = 1, prob = probabilities)


# draw a sample 100 times and visualize the distribution
my_sample <- sample(tomorrow, size = 100, replace = TRUE, prob = probabilities)

# visualize the distribution
barplot(table(my_sample))

```

*** =sct
```{r}
# submission correctness tests

# example tests:
# test_output_contains("output")
# test_object("object_name")
# test_function("function_name", args=c("arg1"))

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Good work! And now you know the probability of world ending...")

```

--- type:NormalExercise lang:r xp:100 skills:1 key:6780cce146

## Normal distribution (1)

[Normal distribution](https://en.wikipedia.org/wiki/Normal_distribution) is continious distribution and it is often used in statistics. It has two parameters (expected value and standard deviation) which determine the shape and place of the distribution. Many human attributes are can be said to be normally distributed. For example, if you take a village full of people, their heights will create a distribution that resembles a normal distribution. 

In R the functions associated with normal distiribution are:

- `dnorm()`: density of the normal distribution
- `pnorm()`: distribution function of normal distribution
- `qnorm()`: quantile function of normal distribution
- `rnorm()`: (random) sample from normal distribution

In this exercise, we will focus on the `rnorm()` function. It draws a random sample from normal distribution (with specified parameters). 

*** =instructions
- Execute the line for `normal_sample`. Note the mean and standard deviation values.
- Draw a histogram of `normal_sample`. Do you notice the shape of the distribution?
- Calculate the mean and standard deviation of `normal_sample`. Save the values to `normal_mean` and `normal_sd`. Print the results.
- Change the mean value to `35` in the `rnorm()` function and run all the codes again. What happened to the normal distribution?
- Change the sd value to `0.1` in the `rnorm()` function and run all the codes again. What happened to the normal distribution?

*** =hint
- The `hist()` function has a mandatory argument `breaks` that needs to be specified.
- You can calculate mean with the function `mean()`.
- You can calculate standard deviation with the function `sd()`.

*** =pre_exercise_code
```{r}
# pre exercise code here
```

*** =sample_code
```{r}
# Create a sample from normal distribution. In this case, the first argument (500) means the sample size.
normal_sample <- rnorm(500, mean = 5, sd = 2.5)

# Histogram of my_sample
hist(normal_sample, breaks = 50)

# Calculate the mean and standard deviation of my_sample. Print the results.
normal_mean <-
normal_sd <-




```

*** =solution
```{r}
# Create a sample from normal distribution. In this case, the first argument (500) means the sample size.
normal_sample <- rnorm(500, mean = 35, sd = 0.1)

# Histogram of my_sample
hist(normal_sample, breaks = 50)

# Calculate the mean and standard deviation of my_sample. Print the results.
normal_mean <- mean(normal_sample)
normal_sd <- sd(normal_sample)

normal_mean
normal_sd

```

*** =sct
```{r}
# submission correctness tests

# example tests:
# test_output_contains("output")
# test_object("object_name")
# test_function("function_name", args=c("arg1"))

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Good work!")

```

--- type:NormalExercise lang:r xp:100 skills:1 key:271171917b

## Normal distribution (2)

It is good to know the formulas behind every calculations when you are dealing with probabilities. But in reality you rarely do the calculations by hand. And why would you, when you have R to calculate them for you!

The function `pnorm()` can be used to calculate probabilities from normal distributions. 

*** =instructions
- The distribution of variable deep resembles a normal distribution (look at the density histogram of deep). The density histogram is drawn with the argument `freq = FALSE` in the `hist()` function.
- If we wanted to know what is the probability that deep learning is smaller than 3 amongst the students, we could calculate it with the `pnorm()` function.
- If we would be interested in the probability that deep learning is greater than 3 amongst the students, we can change the `lower.tail` to `FALSE` to get the correct result.
- Calculations can be done to get the probability that deep learning is between 3 and 4. See the sample code.
- What is the probability that deep learning is over 4.5 ? Save the answer to object `high_learning`.

*** =hint
- hint 1
- hint 2


*** =pre_exercise_code
```{r}
learning2014 <-  read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)

hist(learning2014$deep, freq = F, col='orange')
```

*** =sample_code
```{r}
# learning2014 is available

# Histogram of 'deep'
hist(learning2014$deep, freq = F, col='orange')

# The probability of deep being smaller than 3. Note the lower.tail = TRUE argument.
pnorm(3, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = TRUE)

# The probability of deep being greater than 3. Note the lower.tail = FALSE argument.
pnorm(3, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = FALSE)

# The probability of deep being between 3 and 4.
prob_three <- pnorm(3, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = TRUE)
prob_four <- pnorm(4, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = TRUE)

prob_four - prob_three

#  The probability of deep being over 4.5


```

*** =solution
```{r}
# learning2014 is available

# Histogram of 'deep'
hist(learning2014$deep, freq = F, col='orange')

# The probability of deep being smaller than 3. Note the lower.tail = TRUE argument.
pnorm(3, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = TRUE)

# The probability of deep being greater than 3. Note the lower.tail = FALSE argument.
pnorm(3, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = FALSE)

# The probability of deep being between 3 and 4.
prob_three <- pnorm(3, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = TRUE)
prob_four <- pnorm(4, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = TRUE)

prob_four - prob_three

#  The probability of deep being over 4.5
high_learning <- pnorm(4.5, mean = mean(learning2014$deep), sd = sd(learning2014$deep), lower.tail = FALSE)

```

*** =sct
```{r}
# submission correctness tests

# example tests:
# test_output_contains("output")
# test_object("object_name")
# test_function("function_name", args=c("arg1"))

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Good work!")

```
--- type:NormalExercise lang:r xp:100 skills:1 key:8194f8b921

## Binomial distribution

[Binomial distribution](https://en.wikipedia.org/wiki/Binomial_distribution) is a well known discrete probability distribution. The distribution has two parameters: the number of trials (often marked by *n*) and success probability in each trial (usually marked by *p*). An event, that follows binomial distribution is an event with a fixed number of independent trials, each of which can only have two possible outcomes. An example of an binomial experiment could be tossing a coin 20 times to see how many heads occur.

Some of the basic functions associated with binomial distribution are:

- `dbinom()`: density of the binomial distribution
- `pbinom()`: distribution function of binomial distribution
- `qbinom()`: quantile function of binomial distribution
- `rbinom()`: (random) sample from binomial distribution

You can use the `help()` or `?` for any of these functions to see more about them. 

*** =instructions
- instruction 1
- instruction 2

*** =hint
- hint 1
- hint 2


*** =pre_exercise_code
```{r}
# pre exercise code here
```

*** =sample_code
```{r}
# Sampling. 
random_bin <- rbinom(250, 50, prob = 0.5)

hist(random_bin, 25)

```

*** =solution
```{r}
#solution code here
```

*** =sct
```{r}
# submission correctness tests

# example tests:
# test_output_contains("output")
# test_object("object_name")
# test_function("function_name", args=c("arg1"))

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Good work!")

```

--- type:NormalExercise lang:r xp:100 skills:1 key:5e0e2af080

## Create your own functions

There are countless of ready-made functions for you in R. At this point of the course, we have used many functions, for example like `plot()`, `mean()` and `rnorm()`. But it is possible to create your own functions too. Now we will look at the definition of a simple function and learn how to use it (*call* it).

A little recap of functions:
Functions usually have one or more arguments, for which the user can define values when calling the function. Multiple arguments are separated with a comma. The arguments have names, which can (and often should) be used when specifying their values.


*** =instructions
- Look at the definition of the `apple_count()` function and execute the function calls that are defined.
- Create object `my_apples` by directly assigning the output of `apple_count()` to it. Call `apple_count()` with `new_apples = 10` and `apples_stock = 2`. Print `my_apples` to see the output of the function.
- Apples are gone bad! Worms! Create new function `good_apples_count()` that tells how many of the apples are still edible. Give the function to arguments: `apple_amount` and `bad_apples`. Set the amount of apples to be 15 by default.
- You find 4 rotten apples in your stock. Use your function to get the number of the good apples. Save the answer to `my_good_apples`.

*** =hint
- The answer for `my_apples` is of the form: `my_apples <- apple_count(arg1 = ?, arg2 = ?)`
- See how a new function is created by looking the code of `apple_count`. 
- The amount of good apples is the difference of `apple_amount` and `bad_apples`.
- You can set the default value in `function(arg1 = *insert_default_value_here*, ...) ...`

*** =pre_exercise_code
```{r}
apple_count <- function(new_apples, apples_stock = 5) return(new_apples + apples_stock)
```

*** =sample_code
```{r}
# Create a simple function with two arguments, of which 'apples_stock' has a default value (5)
apple_count <- function(new_apples, apples_stock = 5) return(new_apples + apples_stock)

# Call the apple_count() function. Can you guess the result?
apple_count(new_apples = 2)

# Call apple_count() to create the object 'my_apples'. Print the results.
my_apples <- 


# New function here!
good_apples_count <-

# How many good apples do you have?
my_good_apples <- 
  
```

*** =solution
```{r}
# Create a simple function with two arguments, of which 'apples_stock' has a default value (5)
apple_count <- function(new_apples, apples_stock = 5) return(new_apples + apples_stock)

# Call the apple_count() function. Can you guess the result?
apple_count(new_apples = 2)

# Call apple_count() to create the object 'my_apples'. Print the results.
my_apples <- apple_count(10, apples_stock = 2)


# New function here!
good_apples_count <- function(apple_amount = 15, bad_apples) return(apple_amount - bad_apples)

# How many good apples do you have?
my_good_apples <- good_apples_count(bad_apples = 4)
  
```

*** =sct
```{r}
test_object("my_apples")
test_object("my_good_apples")

test_error()
success_msg("Not eating worms tonight! Nicely done!")
```

--- type:NormalExercise lang:r xp:100 skills:1 key:8ca0f12d3d

## Standardization

When we have a normal distribution that has 0 as expected value and 1 as standard deviation, the distribution is called *standard* normal distribution. A handy thing is that in standard normal distributions about 68% of the observations are within one deviation amount away from the expected value and within two deviations away are 95% of the observations. This can be convinient sometimes. [Standardization](https://en.wikipedia.org/wiki/Standard_score) is used when we want to transform a normal distribution to a standardized normal distribution. Standardized normal distribution has 0 as expected value and 1 as standard deviation. 

The formula for standarzation is
$$z = \frac{x - \mu}{\sigma}$$

where x is the object we want to standardize, $\mu$ is mean and $\sigma$ stands for standard deviation. 

*** =instructions
- Draw first a histogram of `age` from the `learning2014`. Note the x-axis of the histogram: the numbers are ages and you can see how they are distributed in the data.
- Let's create a function that standardizes normal distributions. Save the function as `standarzation`. See the pattern above. You can check from the previous exercise how functions are made. 
- Standardize variable `age` by using the function you created.
- Draw a histogram of standardized variable `standard_age`. Note what happened to the x-axis.


*** =hint
- Remember to use `$`-mark when accessing variables from dataset.
- See `?hist()` if you don't remember how to draw histograms.
- The code `*name_if_the_function* <- function(...) return (...)` is used when creating a function.
- The function creation code needs to be in one line to work correctly.


*** =pre_exercise_code
```{r}
learning2014 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/learning2014.txt", sep = "\t", header = TRUE)
```

*** =sample_code
```{r}
# learning2014 is available

# Draw a histogram of variable 'age'
hist(learning2014$age, breaks=25)

# Create function standardation. 
standarzation <- 

# Standardize variable 'age' by using the function you created
standard_age <-

# Draw a histogram of standardized variable 'age'
hist(standard_age, breaks=25)

```

*** =solution
```{r}
# learning2014 is available

# Draw a histogram of variable 'age'
hist(learning2014$age, breaks=25)

# Create function standardation
standarzation <- function(x) return( ( x-mean(x) ) / sd(x) )

# Standardize variable 'age' by using the function you created
standard_age <- standarzation(learning2014$age)

# Draw a plot of standardized variable 'age'
hist(standard_age, breaks=25)

```

*** =sct
```{r}
# submission correctness tests

# example tests:
# test_output_contains("output")
# test_object("object_name")
# test_function("function_name", args=c("arg1"))

# test if the students code produces an error
test_error()

# Final message the student will see upon completing the exercise
success_msg("Good work!")

```
--- type:MultipleChoiceExercise lang:r xp:100 skills:1 key:6c27606d58

## Uniform distribution

The uniform distribution can be [discrete uniform distribution](https://en.wikipedia.org/wiki/Discrete_uniform_distribution) or

[continious uniform distribution](https://en.wikipedia.org/wiki/Uniform_distribution_(continuous)). The uniform distribution is a distribution, that has constant probability. 

An example of event that follows (discrete) uniform distribution is dice throwing (assuming the dice is not weighted). In dice there are six possible values and the probability to every value is 1/6.

At the right you can see four plots. Can you guess which ones are the density plots of continious and discrete uniform distributions?

*** =instructions
- Plot A is discrete uniform distribution and plot B is the density of continious uniform distribution.
- There is no discrete uniform distribution, but plot C is the continious uniform distribution. 
- Plot D is discrete uniform distribution and plot A is continious uniform distribution.
- Plot D is discrete uniform distribution and plot C is continious uniform distribution.

*** =hint
- In uniform distribution, all the values of x get the same probability.
- Plot B is actually not a density, but a plot of cumulative distribution function.
- There are "gaps"" in the density if the distribution is discrete.


*** =pre_exercise_code
```{r}
# pre exercise code here
x <- seq(-5, 20, length = 50)
y<-'density'
color<-"orange"
par(lwd=2, mfrow=c(2,2), cex.lab=1.5, cex.main=1.2)
plot(x, dunif(x, 0, 15), type='s', ylim=c(0,.15), col=color, ylab=y, main='Plot A')
plot(x, punif(x, 0, 15), type='l', col=color, ylab=y, main='Plot B')
plot(x, dnorm(x, 5, 2), type='l',col=color, ylab=y, main='Plot C')
plot(x, dunif(x, 0, 15), type='h', ylim=c(0,.15), col=color, ylab=y, main='Plot D')
```

*** =sct
```{r}
msg1 = "Plot A is not discrete, sorry. Plot B is continious, but it's a cumulative distribution function of uniform distribution."
msg2 = "The discrete one does exist, sorry. Also, plot C is normal distribution."
msg3 = "You are totally right! Proceed to the next exercise."
msg4 = "Sorry, plot C is normal distribution. But you got plot D right!"

# test_mc(correct = 3, feedback_msgs = c(msg1,msg2,msg3,msg4))

# Final message the student will see upon completing the exercise
success_msg("Nicely done!")

```

